import com.opencsv.CSVReader;
import com.opencsv.CSVWriter;
import com.opencsv.exceptions.CsvValidationException;

import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;

public class ProcessCSV {
    public static void main(String[] args) throws IOException, CsvValidationException {
        // Input CSV file path
        String inputFile = "input.csv";

        // Output CSV file path
        String outputFile = "output.csv";

        // Initialize CSV reader and writer
        CSVReader reader = new CSVReader(new FileReader(inputFile));
        CSVWriter writer = new CSVWriter(new FileWriter(outputFile));

        // Read the header and add a new header column for status
        String[] header = reader.readNext();
        String[] newHeader = new String[header.length + 1];
        System.arraycopy(header, 0, newHeader, 0, header.length);
        newHeader[header.length] = "Status";
        writer.writeNext(newHeader);

        String[] row;
        while ((row = reader.readNext()) != null) {
            // Process your data here; for demonstration purposes, we'll just print it
            System.out.println("Processing Row: " + row[0] + ", " + row[1]);

            // Your processing logic goes here
            boolean success = processRow(row[0], row[1]); // Replace with your actual processing logic

            // Add the status (success or failed) to the row
            String[] newRow = new String[row.length + 1];
            System.arraycopy(row, 0, newRow, 0, row.length);
            newRow[row.length] = success ? "Success" : "Failed";

            // Write the processed row to the output CSV
            writer.writeNext(newRow);
        }

        // Close the reader and writer
        reader.close();
        writer.close();
    }

    // Replace this method with your actual processing logic
    private static boolean processRow(String column1, String column2) {
        // Example: You can implement your processing logic here
        // For this example, we'll consider it successful if column1 is not empty.
        return !column1.isEmpty();
    }
}
