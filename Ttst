import com.opencsv.CSVReader;
import com.opencsv.CSVWriter;

import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class CsvFileManipulation {
    public static void main(String[] args) {
        String inputFile = "your_file.csv"; // Replace with your CSV file

        try (CSVReader reader = new CSVReader(new FileReader(inputFile));
             CSVWriter writer = new CSVWriter(new FileWriter(inputFile))) {

            List<String[]> lines = reader.readAll();

            // Add a new column header
            String[] header = lines.get(0);
            header = addNewColumn(header, "NewColumn");

            // Add data to the new column
            for (int i = 1; i < lines.size(); i++) {
                String[] line = lines.get(i);
                line = addNewColumn(line, "NewData" + i); // Replace with your data
            }

            // Write the modified data back to the same CSV file
            writer.writeAll(lines);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static String[] addNewColumn(String[] row, String newData) {
        String[] newRow = new String[row.length + 1];
        System.arraycopy(row, 0, newRow, 0, row.length);
        newRow[row.length] = newData;
        return newRow;
    }
}
